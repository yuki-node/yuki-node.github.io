---
title: 'MySQL 高可用架构'
date: '2024-11-17T22:58:24+08:00'
draft: false
tags: ['MySQL', '数据库']
keywords: []
author: "Yuki"
---

## 前言

PXC：Percona XtraDB Cluster

PXC 特性：

- 同步复制，强一致性、无同步延迟
- 多主复制，任一节点可读可写
- 并行复制，基于行的并行复制
- 强一致性，每个节点都包含完整的数据副本
- 自动添加节点，新节点自动同步全量数据

PXC 限制

- 只支持 INNODB 表
- 不允许大事务的产生
- 写性能取决于最差的节点
- 不能解决热点更新问题

## 架构原理

至少使用 3节点，每个节点都是一个 MySQL Server

## 备份
备份使用

## 还原

## PITR

## Binlog 快速恢复

## 数据库巡检

巡检：主机/OS级别巡检 -> MySQL 巡检 -> 人工/智能分析

## 主机/OS级别巡检

主机/OS级别巡检主要关注以下几个方面:

1. 系统基本信息

   - 操作系统版本和内核版本
   - 系统运行时间
   - 系统负载情况
   - 系统时间同步状态

2. 资源使用情况

   - CPU使用率和负载
   - 内存使用率和交换分区使用情况
   - 磁盘空间使用率
   - 网络带宽使用情况

3. 系统进程

   - 进程总数和运行状态
   - 僵尸进程检查
   - 关键进程存活检查

4. 系统日志

   - 系统错误日志检查
   - 安全日志检查
   - 硬件故障日志检查

5. 系统安全

   - 系统用户检查
   - 系统服务检查
   - 系统端口检查
   - 防火墙规则检查
   - 系统文件权限检查

6. 系统性能

   - I/O等待时间
   - 网络延迟
   - 系统调用统计

### 主机硬件配置

### CPU/内存/磁盘使用率

### I/O使用情况

## MySQL 巡检

### 备份情况

### 配置

### 用户权限

### Top10 SQL

## 人工智能分析

### 慢 SQL 语句获取

### 优化建议
